<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Reorder sections — epub_reorder • epubr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Reorder sections — epub_reorder" />
<meta property="og:description" content="Reorder text sections in an e-book based on a user-provided function." />
<meta property="og:image" content="https://docs.ropensci.org/epubr/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epubr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/epubr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ropensci/epubr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Reorder sections</h1>
    <small class="dont-index">Source: <a href='https://github.com/ropensci/epubr/blob/master/R/reorder.R'><code>R/reorder.R</code></a></small>
    <div class="hidden name"><code>epub_reorder.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Reorder text sections in an e-book based on a user-provided function.</p>
    </div>

    <pre class="usage"><span class='fu'>epub_reorder</span>(<span class='no'>data</span>, <span class='no'>.f</span>, <span class='no'>pattern</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>a data frame created by <code>epub</code>.</p></td>
    </tr>
    <tr>
      <th>.f</th>
      <td><p>a scalar function to determine a single row index based on a matched regular expression. It must take two strings, the text and the pattern, and return a single number. See examples.</p></td>
    </tr>
    <tr>
      <th>pattern</th>
      <td><p>regular expression passed to <code>.f</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a data frame</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Many e-books have chronologically ordered sections based on quality metadata.
This results in properly book sections in the nested data frame.
However, some poorly formatted e-books have their internal sections occur in an arbitrary order.
This can be frustrating to work with when doing text analysis on each section and where order matters.</p>
<p>This function addresses this case by reordering the text sections in the nested data frame based on a user-provided function that re-indexes the data frame rows based on their content.
In general, the approach is to find something in the content of each section that describes the section order.
For example, <code>epub_recombine</code> can use a regular expression to identify chapters.
Taking this a step further, <code>epub_reorder</code> can use a function that works with the same information to reorder the rows.</p>
<p>It is enough in the former case to identify where in the text the pattern occurs. There is no need to extract numeric ordering from it.
The latter takes more effort. In the example EPUB file included in <code>epubr</code>, chapters can be identified using a pattern of the word CHAPTER in capital letters followed by a space and then some Roman numerals.
The user must provide a function that would parse the Roman numerals in this pattern so that the rows of the data frame can be reordered properly.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='no'>file</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"dracula.epub"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"epubr"</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='epub.html'>epub</a></span>(<span class='no'>file</span>) <span class='co'># parse entire e-book</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='epub_recombine.html'>epub_recombine</a></span>(<span class='no'>x</span>, <span class='st'>"CHAPTER [IVX]+"</span>, <span class='kw'>sift</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1000</span>)) <span class='co'># clean up</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dplyr</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'dplyr'</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from 'package:stats':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    filter, lag</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from 'package:base':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    intersect, setdiff, setequal, union</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>x</span>$<span class='no'>data</span><span class='kw'>[[</span><span class='fl'>1</span>]] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/sample.html'>sample_frac</a></span>(<span class='no'>x</span>$<span class='no'>data</span><span class='kw'>[[</span><span class='fl'>1</span>]]) <span class='co'># randomize rows for example</span>
<span class='no'>x</span>$<span class='no'>data</span><span class='kw'>[[</span><span class='fl'>1</span>]]</div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 27 x 4</span><span>
#&gt;    section text                                                      nword nchar
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>                                                     </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> ch25    </span><span style='color: #555555;'>"</span><span>CHAPTER XXVDR. SEWARD'S DIARY\n11 October, Evening.-Jon~  </span><span style='text-decoration: underline;'>6</span><span>214 </span><span style='text-decoration: underline;'>32</span><span>544
#&gt; </span><span style='color: #555555;'> 2</span><span> ch04    </span><span style='color: #555555;'>"</span><span>CHAPTER IVJONATHAN HARKER'S JOURNAL-continued\nI AWOKE ~  </span><span style='text-decoration: underline;'>5</span><span>828 </span><span style='text-decoration: underline;'>30</span><span>195
#&gt; </span><span style='color: #555555;'> 3</span><span> ch07    </span><span style='color: #555555;'>"</span><span>CHAPTER VIICUTTING FROM \"THE DAILYGRAPH,\" 8 AUGUST\n(~  </span><span style='text-decoration: underline;'>5</span><span>567 </span><span style='text-decoration: underline;'>29</span><span>912
#&gt; </span><span style='color: #555555;'> 4</span><span> ch01    </span><span style='color: #555555;'>"</span><span>CHAPTER IJONATHAN HARKER'S JOURNAL\n(Kept in shorthand.~  </span><span style='text-decoration: underline;'>5</span><span>694 </span><span style='text-decoration: underline;'>30</span><span>602
#&gt; </span><span style='color: #555555;'> 5</span><span> ch02    </span><span style='color: #555555;'>"</span><span>CHAPTER IIJONATHAN HARKER'S JOURNAL-continued\n5 May.-I~  </span><span style='text-decoration: underline;'>5</span><span>476 </span><span style='text-decoration: underline;'>28</span><span>462
#&gt; </span><span style='color: #555555;'> 6</span><span> ch11    </span><span style='color: #555555;'>"</span><span>CHAPTER XI\nLucy Westenra's Diary.\n12 September.-How g~  </span><span style='text-decoration: underline;'>5</span><span>126 </span><span style='text-decoration: underline;'>26</span><span>926
#&gt; </span><span style='color: #555555;'> 7</span><span> ch14    </span><span style='color: #555555;'>"</span><span>CHAPTER XIVMINA HARKER'S JOURNAL\n23 September.-Jonatha~  </span><span style='text-decoration: underline;'>6</span><span>411 </span><span style='text-decoration: underline;'>32</span><span>530
#&gt; </span><span style='color: #555555;'> 8</span><span> ch18    </span><span style='color: #555555;'>"</span><span>CHAPTER XVIIIDR. SEWARD'S DIARY\n30 September.-I got ho~  </span><span style='text-decoration: underline;'>6</span><span>911 </span><span style='text-decoration: underline;'>35</span><span>881
#&gt; </span><span style='color: #555555;'> 9</span><span> ch19    </span><span style='color: #555555;'>"</span><span>CHAPTER XIXJONATHAN HARKER'S JOURNAL\n1 October, 5 a. m~  </span><span style='text-decoration: underline;'>5</span><span>670 </span><span style='text-decoration: underline;'>29</span><span>431
#&gt; </span><span style='color: #555555;'>10</span><span> ch24    </span><span style='color: #555555;'>"</span><span>CHAPTER XXIVDR. SEWARD'S PHONOGRAPH DIARY, SPOKEN BY VA~  </span><span style='text-decoration: underline;'>6</span><span>272 </span><span style='text-decoration: underline;'>32</span><span>065
#&gt; </span><span style='color: #555555;'># ... with 17 more rows</span><span></div><div class='input'>
<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>pattern</span>) <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='fu'><a href='https://rdrr.io/r/utils/roman.html'>as.roman</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span>(<span class='no'>pattern</span>, <span class='st'>"\"</span>, <span class='no'>x</span>)))
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>epub_reorder</span>(<span class='no'>x</span>, <span class='no'>f</span>, <span class='st'>"^CHAPTER ([IVX]+).*"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: invalid roman numerals:                           </span></div><div class='input'><span class='no'>x</span>$<span class='no'>data</span><span class='kw'>[[</span><span class='fl'>1</span>]]</div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 27 x 4</span><span>
#&gt;    section text                                                      nword nchar
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>                                                     </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> ch25    </span><span style='color: #555555;'>"</span><span>CHAPTER XXVDR. SEWARD'S DIARY\n11 October, Evening.-Jon~  </span><span style='text-decoration: underline;'>6</span><span>214 </span><span style='text-decoration: underline;'>32</span><span>544
#&gt; </span><span style='color: #555555;'> 2</span><span> ch04    </span><span style='color: #555555;'>"</span><span>CHAPTER IVJONATHAN HARKER'S JOURNAL-continued\nI AWOKE ~  </span><span style='text-decoration: underline;'>5</span><span>828 </span><span style='text-decoration: underline;'>30</span><span>195
#&gt; </span><span style='color: #555555;'> 3</span><span> ch07    </span><span style='color: #555555;'>"</span><span>CHAPTER VIICUTTING FROM \"THE DAILYGRAPH,\" 8 AUGUST\n(~  </span><span style='text-decoration: underline;'>5</span><span>567 </span><span style='text-decoration: underline;'>29</span><span>912
#&gt; </span><span style='color: #555555;'> 4</span><span> ch01    </span><span style='color: #555555;'>"</span><span>CHAPTER IJONATHAN HARKER'S JOURNAL\n(Kept in shorthand.~  </span><span style='text-decoration: underline;'>5</span><span>694 </span><span style='text-decoration: underline;'>30</span><span>602
#&gt; </span><span style='color: #555555;'> 5</span><span> ch02    </span><span style='color: #555555;'>"</span><span>CHAPTER IIJONATHAN HARKER'S JOURNAL-continued\n5 May.-I~  </span><span style='text-decoration: underline;'>5</span><span>476 </span><span style='text-decoration: underline;'>28</span><span>462
#&gt; </span><span style='color: #555555;'> 6</span><span> ch11    </span><span style='color: #555555;'>"</span><span>CHAPTER XI\nLucy Westenra's Diary.\n12 September.-How g~  </span><span style='text-decoration: underline;'>5</span><span>126 </span><span style='text-decoration: underline;'>26</span><span>926
#&gt; </span><span style='color: #555555;'> 7</span><span> ch14    </span><span style='color: #555555;'>"</span><span>CHAPTER XIVMINA HARKER'S JOURNAL\n23 September.-Jonatha~  </span><span style='text-decoration: underline;'>6</span><span>411 </span><span style='text-decoration: underline;'>32</span><span>530
#&gt; </span><span style='color: #555555;'> 8</span><span> ch18    </span><span style='color: #555555;'>"</span><span>CHAPTER XVIIIDR. SEWARD'S DIARY\n30 September.-I got ho~  </span><span style='text-decoration: underline;'>6</span><span>911 </span><span style='text-decoration: underline;'>35</span><span>881
#&gt; </span><span style='color: #555555;'> 9</span><span> ch19    </span><span style='color: #555555;'>"</span><span>CHAPTER XIXJONATHAN HARKER'S JOURNAL\n1 October, 5 a. m~  </span><span style='text-decoration: underline;'>5</span><span>670 </span><span style='text-decoration: underline;'>29</span><span>431
#&gt; </span><span style='color: #555555;'>10</span><span> ch24    </span><span style='color: #555555;'>"</span><span>CHAPTER XXIVDR. SEWARD'S PHONOGRAPH DIARY, SPOKEN BY VA~  </span><span style='text-decoration: underline;'>6</span><span>272 </span><span style='text-decoration: underline;'>32</span><span>065
#&gt; </span><span style='color: #555555;'># ... with 17 more rows</span><span></div><div class='input'># }
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://github.com/leonawicz/'>Matthew Leonawicz</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


